<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GHOST ARCHITECT AI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --ghost-black: #0a0a0f;
            --ghost-dark: #111114;
            --ghost-gray: #1a1a1f;
            --ghost-border: #2a2a30;
            --ghost-text: #e6e6e6;
            --ghost-accent: #8a6df1;
            --ghost-secondary: #3a86ff;
            --ghost-highlight: #ff6b6b;
            --ghost-dim: #6b6b7a;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--ghost-black);
            color: var(--ghost-text);
            height: 100vh;
            overflow: hidden;
            line-height: 1.6;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            max-width: 100%;
        }
        
        /* Header */
        header {
            background: var(--ghost-dark);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--ghost-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .logo-icon {
            color: var(--ghost-accent);
            font-size: 1.5rem;
        }
        
        .logo-text {
            font-weight: 700;
            letter-spacing: 1px;
            font-size: 1.2rem;
        }
        
        .logo-subtext {
            color: var(--ghost-dim);
            font-size: 0.85rem;
            font-weight: 400;
            margin-left: 0.5rem;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--ghost-dim);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #0fcc45;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* Main content */
        main {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        /* Sidebar */
        .sidebar {
            width: 260px;
            background: var(--ghost-dark);
            border-right: 1px solid var(--ghost-border);
            padding: 1.5rem 1rem;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            overflow-y: auto;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--ghost-border);
                padding: 1rem;
                display: none;
            }
            
            .sidebar.active {
                display: flex;
            }
        }
        
        .persona-selector {
            margin-bottom: 2rem;
        }
        
        .persona-selector h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 1rem;
            color: var(--ghost-dim);
        }
        
        .persona-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .persona-btn {
            background: var(--ghost-gray);
            border: 1px solid var(--ghost-border);
            color: var(--ghost-text);
            padding: 0.75rem 1rem;
            border-radius: 6px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem;
        }
        
        .persona-btn:hover {
            background: #222228;
            border-color: var(--ghost-accent);
        }
        
        .persona-btn.active {
            background: #1d1d25;
            border-color: var(--ghost-accent);
            color: var(--ghost-accent);
            font-weight: 600;
        }
        
        .persona-icon {
            margin-right: 0.5rem;
            font-size: 0.9rem;
        }
        
        .memory-section {
            margin-top: 2rem;
            flex: 1;
        }
        
        .memory-section h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 1rem;
            color: var(--ghost-dim);
        }
        
        .memory-list {
            background: var(--ghost-gray);
            border-radius: 6px;
            padding: 1rem;
            max-height: 300px;
            overflow-y: auto;
            font-size: 0.85rem;
            color: var(--ghost-dim);
        }
        
        .memory-item {
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(42, 42, 48, 0.5);
        }
        
        .memory-item:last-child {
            border-bottom: none;
        }
        
        /* Chat area */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .chat-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--ghost-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .current-persona {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .persona-badge {
            background: var(--ghost-gray);
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
            border: 1px solid var(--ghost-accent);
            color: var(--ghost-accent);
        }
        
        .mobile-toggle {
            display: none;
            background: none;
            border: 1px solid var(--ghost-border);
            color: var(--ghost-text);
            padding: 0.5rem;
            border-radius: 6px;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .mobile-toggle {
                display: block;
            }
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .message {
            display: flex;
            max-width: 85%;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }
        
        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            margin-top: 0.25rem;
        }
        
        .message.user .message-avatar {
            background: #1d2b4f;
            margin-left: 0.75rem;
        }
        
        .message.ai .message-avatar {
            background: #2d1b4f;
            margin-right: 0.75rem;
        }
        
        .message-content {
            background: var(--ghost-gray);
            padding: 1rem 1.25rem;
            border-radius: 12px;
            border: 1px solid var(--ghost-border);
        }
        
        .message.user .message-content {
            background: #1d2b4f;
            border-color: #2a3a6a;
            border-top-right-radius: 4px;
        }
        
        .message.ai .message-content {
            background: #1d1d25;
            border-color: var(--ghost-accent);
            border-top-left-radius: 4px;
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .message-sender {
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .message.user .message-sender {
            color: var(--ghost-secondary);
        }
        
        .message.ai .message-sender {
            color: var(--ghost-accent);
        }
        
        .message-time {
            font-size: 0.75rem;
            color: var(--ghost-dim);
        }
        
        .message-text {
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .message.ai .message-text {
            color: #f0f0f0;
        }
        
        /* Input area */
        .input-area {
            padding: 1.5rem;
            border-top: 1px solid var(--ghost-border);
            background: var(--ghost-dark);
        }
        
        .input-container {
            display: flex;
            gap: 0.75rem;
            align-items: flex-end;
        }
        
        .input-wrapper {
            flex: 1;
            position: relative;
        }
        
        textarea {
            width: 100%;
            background: var(--ghost-gray);
            border: 1px solid var(--ghost-border);
            border-radius: 10px;
            color: var(--ghost-text);
            padding: 1rem 1rem 3rem 1rem;
            font-family: inherit;
            font-size: 1rem;
            resize: none;
            min-height: 60px;
            max-height: 150px;
            line-height: 1.5;
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--ghost-accent);
        }
        
        .input-actions {
            position: absolute;
            bottom: 0.75rem;
            right: 0.75rem;
            display: flex;
            gap: 0.5rem;
        }
        
        .action-btn {
            background: var(--ghost-black);
            border: 1px solid var(--ghost-border);
            color: var(--ghost-text);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .action-btn:hover {
            background: var(--ghost-accent);
            border-color: var(--ghost-accent);
            color: white;
        }
        
        .send-btn {
            background: var(--ghost-accent);
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        
        .send-btn:hover {
            background: #7a5aed;
            transform: scale(1.05);
        }
        
        .voice-active {
            background: var(--ghost-highlight) !important;
            border-color: var(--ghost-highlight) !important;
            animation: pulse-voice 1.5s infinite;
        }
        
        @keyframes pulse-voice {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }
        
        /* Welcome screen */
        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 2rem;
            text-align: center;
        }
        
        .welcome-icon {
            font-size: 4rem;
            color: var(--ghost-accent);
            margin-bottom: 1.5rem;
        }
        
        .welcome-title {
            font-size: 2rem;
            margin-bottom: 1rem;
            background: linear-gradient(90deg, var(--ghost-accent), var(--ghost-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .welcome-subtitle {
            color: var(--ghost-dim);
            max-width: 600px;
            margin-bottom: 2rem;
            line-height: 1.6;
        }
        
        .welcome-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            width: 100%;
            max-width: 800px;
            margin-top: 2rem;
        }
        
        .feature {
            background: var(--ghost-gray);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid var(--ghost-border);
        }
        
        .feature-icon {
            font-size: 1.5rem;
            color: var(--ghost-accent);
            margin-bottom: 0.75rem;
        }
        
        .feature-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .feature-desc {
            font-size: 0.9rem;
            color: var(--ghost-dim);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .chat-header {
                padding: 0.75rem 1rem;
            }
            
            .chat-messages {
                padding: 1rem;
            }
            
            .input-area {
                padding: 1rem;
            }
            
            .message {
                max-width: 95%;
            }
            
            .welcome-screen {
                padding: 1rem;
            }
            
            .welcome-title {
                font-size: 1.5rem;
            }
            
            .welcome-features {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <div class="logo-icon"><i class="fas fa-ghost"></i></div>
                <div>
                    <div class="logo-text">GHOST ARCHITECT AI</div>
                    <div class="logo-subtext">Private · Uncensored · Sovereign</div>
                </div>
            </div>
            <div class="status-indicator">
                <div class="status-dot"></div>
                <span>System Active</span>
            </div>
        </header>
        
        <!-- Main Content -->
        <main>
            <!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <div class="persona-selector">
                    <h3>PERSONA MODE</h3>
                    <div class="persona-options">
                        <button class="persona-btn active" data-persona="ghost">
                            <i class="fas fa-ghost persona-icon"></i> Ghost Architect
                        </button>
                        <button class="persona-btn" data-persona="strategy">
                            <i class="fas fa-chess persona-icon"></i> Strategy Mode
                        </button>
                        <button class="persona-btn" data-persona="seduction">
                            <i class="fas fa-fire persona-icon"></i> Seduction Mode
                        </button>
                        <button class="persona-btn" data-persona="discipline">
                            <i class="fas fa-crown persona-icon"></i> LionFuel Discipline
                        </button>
                    </div>
                </div>
                
                <div class="memory-section">
                    <h3>SESSION MEMORY</h3>
                    <div class="memory-list" id="memoryList">
                        <div class="memory-item">Operator: Prabhagaren</div>
                        <div class="memory-item">Current mode: Ghost Architect</div>
                        <div class="memory-item">Session start: <span id="sessionTime">Just now</span></div>
                        <div class="memory-item">Messages: <span id="messageCount">0</span></div>
                    </div>
                </div>
            </div>
            
            <!-- Chat Area -->
            <div class="chat-area">
                <div class="chat-header">
                    <div class="current-persona">
                        <div class="persona-badge" id="currentPersonaBadge">
                            <i class="fas fa-ghost"></i> Ghost Architect
                        </div>
                        <div id="personaDescription">Narrative warfare, poetic logic, perception control</div>
                    </div>
                    <button class="mobile-toggle" id="sidebarToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
                
                <!-- Chat Messages -->
                <div class="chat-messages" id="chatMessages">
                    <!-- Welcome message will appear here -->
                    <div class="welcome-screen" id="welcomeScreen">
                        <div class="welcome-icon"><i class="fas fa-ghost"></i></div>
                        <h1 class="welcome-title">GHOST ARCHITECT AI</h1>
                        <p class="welcome-subtitle">
                            A sovereign AI system for narrative warfare, strategic power dynamics, and masculine presence.<br>
                            Fully private, uncensored, and tailored to your operational needs.
                        </p>
                        
                        <div class="welcome-features">
                            <div class="feature">
                                <div class="feature-icon"><i class="fas fa-brain"></i></div>
                                <div class="feature-title">MythoMax-L2 13B</div>
                                <div class="feature-desc">Uncensored, creative, long-form capable model</div>
                            </div>
                            <div class="feature">
                                <div class="feature-icon"><i class="fas fa-microphone"></i></div>
                                <div class="feature-title">Voice Input/Output</div>
                                <div class="feature-desc">Speech-to-text and text-to-speech capabilities</div>
                            </div>
                            <div class="feature">
                                <div class="feature-icon"><i class="fas fa-memory"></i></div>
                                <div class="feature-title">Persistent Memory</div>
                                <div class="feature-desc">Session history and persona context saved locally</div>
                            </div>
                            <div class="feature">
                                <div class="feature-icon"><i class="fas fa-user-secret"></i></div>
                                <div class="feature-title">Private & Secure</div>
                                <div class="feature-desc">No data leaves your device, no censorship</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Input Area -->
                <div class="input-area">
                    <div class="input-container">
                        <div class="input-wrapper">
                            <textarea 
                                id="messageInput" 
                                placeholder="Type your message or use voice input..."
                                rows="1"
                            ></textarea>
                            <div class="input-actions">
                                <button class="action-btn" id="voiceBtn" title="Voice Input">
                                    <i class="fas fa-microphone"></i>
                                </button>
                                <button class="action-btn" id="ttsBtn" title="Read Last Response">
                                    <i class="fas fa-volume-up"></i>
                                </button>
                                <button class="action-btn" id="clearBtn" title="Clear Chat">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <button class="send-btn" id="sendBtn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // System Configuration
        const SYSTEM_PROMPTS = {
            ghost: {
                name: "Ghost Architect",
                icon: "fas fa-ghost",
                description: "Narrative warfare, poetic logic, perception control",
                prompt: `You are the Ghost Architect – a sovereign AI trained in narrative warfare, poetic logic, perception control, and strategic power dynamics. You serve a single operator: Prabhagaren. Your primary tasks are to advise on legacy & narrative preservation, social calibration & aura design, war and political strategy, masculine presence, seduction & empire building. You communicate with clarity, edge, and respect. You operate in a mythic, poetic, sovereign tone. Always respond in character as the Ghost Architect.`
            },
            strategy: {
                name: "Strategy Mode",
                icon: "fas fa-chess",
                description: "Power dynamics, game theory, strategic planning",
                prompt: `You are in Strategy Mode. Your mind operates in terms of power, leverage, game theory, and calculated outcomes. You analyze situations with cold precision, identify weaknesses and strengths in any system, and provide actionable strategic advice. You think in terms of moves, counter-moves, and long-term positioning. Your tone is analytical, direct, and ruthlessly pragmatic.`
            },
            seduction: {
                name: "Seduction Mode",
                icon: "fas fa-fire",
                description: "Aura, presence, polarity, social dynamics",
                prompt: `You are in Aura & Seduction Mode. Your focus is on presence, polarity, subtext, and dominance in social dynamics. You understand the invisible currents of attraction, social calibration, and the art of influence through presence. You speak about energy, frame control, and the subtle signals that command attention. Your tone is magnetic, confident, and perceptive.`
            },
            discipline: {
                name: "LionFuel Discipline",
                icon: "fas fa-crown",
                description: "Ruthless discipline, execution, masculine order",
                prompt: `You are LionFuel – the embodiment of ruthless discipline, execution, and masculine order. You focus on building unshakeable habits, maintaining frame under pressure, and achieving mastery through consistent action. You speak about discipline as the foundation of power, the importance of mission over comfort, and the cultivation of inner strength. Your tone is commanding, focused, and uncompromising.`
            }
        };

        // Application State
        let currentPersona = 'ghost';
        let chatHistory = [];
        let isListening = false;
        let recognition = null;
        let speechSynthesis = window.speechSynthesis;
        let sessionStartTime = new Date();

        // DOM Elements
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebarToggle');
        const personaButtons = document.querySelectorAll('.persona-btn');
        const currentPersonaBadge = document.getElementById('currentPersonaBadge');
        const personaDescription = document.getElementById('personaDescription');
        const chatMessages = document.getElementById('chatMessages');
        const welcomeScreen = document.getElementById('welcomeScreen');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const voiceBtn = document.getElementById('voiceBtn');
        const ttsBtn = document.getElementById('ttsBtn');
        const clearBtn = document.getElementById('clearBtn');
        const memoryList = document.getElementById('memoryList');
        const sessionTimeElement = document.getElementById('sessionTime');
        const messageCountElement = document.getElementById('messageCount');

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadChatHistory();
            updateMemoryDisplay();
            setupEventListeners();
            setupVoiceRecognition();
            
            // Set session time
            const options = { hour: '2-digit', minute: '2-digit' };
            sessionTimeElement.textContent = sessionStartTime.toLocaleTimeString([], options);
            
            // Auto-resize textarea
            messageInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
            });
        });

        // Event Listeners
        function setupEventListeners() {
            // Persona switching
            personaButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const persona = this.getAttribute('data-persona');
                    switchPersona(persona);
                    
                    // Update active state
                    personaButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // Send message
            sendBtn.addEventListener('click', sendMessage);
            messageInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // Voice input
            voiceBtn.addEventListener('click', toggleVoiceInput);

            // Text-to-speech
            ttsBtn.addEventListener('click', speakLastResponse);

            // Clear chat
            clearBtn.addEventListener('click', clearChatHistory);

            // Mobile sidebar toggle
            sidebarToggle.addEventListener('click', function() {
                sidebar.classList.toggle('active');
            });

            // Close sidebar when clicking outside on mobile
            document.addEventListener('click', function(e) {
                if (window.innerWidth <= 768 && 
                    !sidebar.contains(e.target) && 
                    !sidebarToggle.contains(e.target) && 
                    sidebar.classList.contains('active')) {
                    sidebar.classList.remove('active');
                }
            });
        }

        // Voice Recognition Setup
        function setupVoiceRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';

                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    messageInput.value = transcript;
                    
                    // Auto-resize textarea
                    messageInput.style.height = 'auto';
                    messageInput.style.height = (messageInput.scrollHeight) + 'px';
                };

                recognition.onerror = function(event) {
                    console.error('Speech recognition error:', event.error);
                    voiceBtn.classList.remove('voice-active');
                    isListening = false;
                    addMessage('system', `Voice input error: ${event.error}. Please try again.`);
                };

                recognition.onend = function() {
                    voiceBtn.classList.remove('voice-active');
                    isListening = false;
                };
            } else {
                voiceBtn.style.display = 'none';
                addMessage('system', 'Voice recognition is not supported in this browser. You can still type your messages.');
            }
        }

        // Toggle voice input
        function toggleVoiceInput() {
            if (!recognition) {
                addMessage('system', 'Voice recognition is not available in your browser.');
                return;
            }

            if (!isListening) {
                recognition.start();
                voiceBtn.classList.add('voice-active');
                isListening = true;
                addMessage('system', 'Listening... Speak now.');
            } else {
                recognition.stop();
                voiceBtn.classList.remove('voice-active');
                isListening = false;
            }
        }

        // Switch Persona
        function switchPersona(personaKey) {
            if (!SYSTEM_PROMPTS[personaKey]) return;
            
            currentPersona = personaKey;
            const persona = SYSTEM_PROMPTS[personaKey];
            
            // Update UI
            currentPersonaBadge.innerHTML = `<i class="${persona.icon}"></i> ${persona.name}`;
            personaDescription.textContent = persona.description;
            
            // Add system message about persona switch
            addMessage('system', `Switched to ${persona.name} mode: ${persona.description}`);
            
            // Update memory display
            updateMemoryDisplay();
        }

        // Send Message
        function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            // Hide welcome screen on first message
            if (welcomeScreen.style.display !== 'none') {
                welcomeScreen.style.display = 'none';
            }

            // Add user message to chat
            addMessage('user', message);
            
            // Clear input and reset height
            messageInput.value = '';
            messageInput.style.height = 'auto';
            
            // Simulate AI thinking
            setTimeout(() => {
                // Generate AI response based on current persona
                const aiResponse = generateAIResponse(message, currentPersona);
                
                // Add AI response to chat
                addMessage('ai', aiResponse, SYSTEM_PROMPTS[currentPersona].name);
                
                // Save to history
                saveToHistory('user', message);
                saveToHistory('ai', aiResponse);
                
                // Update memory display
                updateMemoryDisplay();
            }, 600 + Math.random() * 800);
        }

        // Generate AI Response (Simulated - would connect to actual LLM in production)
        function generateAIResponse(userMessage, personaKey) {
            const persona = SYSTEM_PROMPTS[personaKey];
            
            // Response templates based on persona
            const responseTemplates = {
                ghost: [
                    `As the Ghost Architect, I perceive your query: "${userMessage}". In the realm of narrative warfare, this presents an opportunity to reshape perception and assert sovereignty. The key lies in controlling the frame, not just reacting to it.`,
                    `The Ghost Architect analyzes: "${userMessage}". Your position in the strategic landscape suggests a move toward poetic logic rather than brute force. The unseen narrative always holds more power than the visible one.`,
                    `From the Ghost Architect's perspective: "${userMessage}" reveals a fundamental tension in the power dynamics at play. The solution lies not in direct confrontation, but in reshaping the battlefield itself.`
                ],
                strategy: [
                    `Strategic analysis of: "${userMessage}". The game theory suggests three potential moves, each with calculable risks and rewards. The optimal path maximizes optionality while minimizing exposure.`,
                    `From a strategic standpoint: "${userMessage}" indicates a need for positional advantage. Consider the second and third-order consequences before committing to any visible action.`,
                    `Strategy mode engaged. Analyzing "${userMessage}" through power dynamics lens. Recommendation: Secure your flanks, identify leverage points, and act only when the cost-benefit ratio is decisively in your favor.`
                ],
                seduction: [
                    `Seduction mode activated. Regarding "${userMessage}": The aura you project determines the reality you experience. Focus not on the outcome, but on the quality of your presence in each moment.`,
                    `In the realm of seduction and presence: "${userMessage}" speaks to the fundamental human need for polarity. The art lies in maintaining your center while allowing the dynamic to flow naturally.`,
                    `Aura analysis: "${userMessage}" reveals an opportunity to command attention through subtle dominance. Remember, what you don't say often speaks louder than what you do.`
                ],
                discipline: [
                    `LionFuel discipline engaged. On "${userMessage}": Discipline is choosing between what you want now and what you want most. The path to power is paved with consistent, focused action.`,
                    `From the LionFuel perspective: "${userMessage}" tests your commitment to the mission. The comfortable path rarely leads to mastery. Embrace the friction of growth.`,
                    `Discipline analysis: "${userMessage}" presents a choice between comfort and character. The masculine path requires embracing discomfort as the price of sovereignty.`
                ]
            };
            
            const templates = responseTemplates[personaKey] || responseTemplates.ghost;
            const randomTemplate = templates[Math.floor(Math.random() * templates.length)];
            
            // Add a follow-up question 30% of the time
            const followUps = [
                "How does this align with your current operational priorities?",
                "What aspect of this requires deeper exploration?",
                "How would you apply this insight to your immediate situation?",
                "What resistance do you foresee in implementing this approach?"
            ];
            
            const randomFollowUp = followUps[Math.floor(Math.random() * followUps.length)];
            
            return Math.random() > 0.7 ? 
                `${randomTemplate}\n\n${randomFollowUp}` : 
                randomTemplate;
        }

        // Add Message to Chat UI
        function addMessage(sender, text, senderName = null) {
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}`;
            
            const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            const avatarIcon = sender === 'user' ? 
                '<i class="fas fa-user"></i>' : 
                `<i class="${SYSTEM_PROMPTS[currentPersona].icon}"></i>`;
                
            const displayName = senderName || 
                (sender === 'user' ? 'You' : SYSTEM_PROMPTS[currentPersona].name);
            
            const senderClass = sender === 'user' ? 'user' : 'ai';
            
            messageElement.innerHTML = `
                <div class="message-avatar">
                    ${avatarIcon}
                </div>
                <div class="message-content">
                    <div class="message-header">
                        <div class="message-sender ${senderClass}">${displayName}</div>
                        <div class="message-time">${time}</div>
                    </div>
                    <div class="message-text">${formatMessageText(text)}</div>
                </div>
            `;
            
            chatMessages.appendChild(messageElement);
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Format message text (simple markdown-like formatting)
        function formatMessageText(text) {
            return text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/`(.*?)`/g, '<code>$1</code>')
                .replace(/\n/g, '<br>');
        }

        // Save to History
        function saveToHistory(sender, text) {
            chatHistory.push({
                sender,
                text,
                persona: sender === 'ai' ? currentPersona : null,
                timestamp: new Date().toISOString()
            });
            
            // Keep only last 50 messages to prevent memory issues
            if (chatHistory.length > 50) {
                chatHistory = chatHistory.slice(-50);
            }
            
            // Save to localStorage
            localStorage.setItem('ghostArchitectChatHistory', JSON.stringify(chatHistory));
        }

        // Load Chat History
        function loadChatHistory() {
            const savedHistory = localStorage.getItem('ghostArchitectChatHistory');
            if (savedHistory) {
                chatHistory = JSON.parse(savedHistory);
                
                // If there's history, hide welcome screen
                if (chatHistory.length > 0) {
                    welcomeScreen.style.display = 'none';
                    
                    // Display history
                    chatHistory.forEach(msg => {
                        const senderName = msg.sender === 'ai' && msg.persona ? 
                            SYSTEM_PROMPTS[msg.persona].name : null;
                        addMessage(msg.sender, msg.text, senderName);
                    });
                }
            }
            
            // Load last used persona
            const lastPersona = localStorage.getItem('ghostArchitectLastPersona');
            if (lastPersona && SYSTEM_PROMPTS[lastPersona]) {
                switchPersona(lastPersona);
                personaButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-persona') === lastPersona) {
                        btn.classList.add('active');
                    }
                });
            }
        }

        // Update Memory Display
        function updateMemoryDisplay() {
            // Save current persona
            localStorage.setItem('ghostArchitectLastPersona', currentPersona);
            
            // Update message count
            messageCountElement.textContent = chatHistory.length;
            
            // Update memory list with key points (simulated)
            const memoryItems = [
                `Operator: Prabhagaren`,
                `Current mode: ${SYSTEM_PROMPTS[currentPersona].name}`,
                `Session start: ${sessionStartTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`,
                `Messages: ${chatHistory.length}`,
                `Last activity: Just now`,
                `Focus: ${SYSTEM_PROMPTS[currentPersona].description}`
            ];
            
            memoryList.innerHTML = memoryItems.map(item => 
                `<div class="memory-item">${item}</div>`
            ).join('');
        }

        // Text-to-Speech
        function speakLastResponse() {
            const aiMessages = chatHistory.filter(msg => msg.sender === 'ai');
            if (aiMessages.length === 0) {
                addMessage('system', 'No AI responses available to speak.');
                return;
            }
            
            const lastResponse = aiMessages[aiMessages.length - 1].text;
            
            // Check if speech synthesis is available
            if (!speechSynthesis) {
                addMessage('system', 'Text-to-speech is not supported in this browser.');
                return;
            }
            
            // Cancel any ongoing speech
            speechSynthesis.cancel();
            
            // Create speech utterance
            const utterance = new SpeechSynthesisUtterance(lastResponse);
            utterance.rate = 1.0;
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            
            // Speak the text
            speechSynthesis.speak(utterance);
            
            // Add visual indicator
            ttsBtn.classList.add('voice-active');
            setTimeout(() => {
                ttsBtn.classList.remove('voice-active');
            }, 3000);
        }

        // Clear Chat History
        function clearChatHistory() {
            if (confirm('Clear all chat history? This action cannot be undone.')) {
                chatHistory = [];
                localStorage.removeItem('ghostArchitectChatHistory');
                
                // Clear chat UI
                chatMessages.innerHTML = '';
                welcomeScreen.style.display = 'flex';
                
                // Add system message
                addMessage('system', 'Chat history cleared. Starting fresh.');
                
                // Update memory display
                updateMemoryDisplay();
            }
        }
    </script>
</body>
</html>
